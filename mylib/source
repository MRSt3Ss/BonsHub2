-- Modern DarkUI Library
local DarkUI = {}

-- Colors
local accentColor = Color3.fromRGB(0, 170, 255)
local backgroundColor = Color3.fromRGB(25, 25, 25)
local sidebarColor = Color3.fromRGB(30, 30, 30)
local elementColor = Color3.fromRGB(40, 40, 40)
local textColor = Color3.fromRGB(255, 255, 255)

-- Tween service for smooth animations
local TweenService = game:GetService("TweenService")

function DarkUI:Load()
    local library = {}
    local tabs = {}
    local currentTab = nil
    local uiVisible = true
    local keybinds = {}
    
    -- Create main UI
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "ModernDarkUI"
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    ScreenGui.Parent = game:GetService("CoreGui")
    
    -- Main container
    local MainFrame = Instance.new("Frame")
    MainFrame.Size = UDim2.new(0, 600, 0, 450)
    MainFrame.Position = UDim2.new(0.5, -300, 0.5, -225)
    MainFrame.BackgroundColor3 = backgroundColor
    MainFrame.BorderSizePixel = 0
    MainFrame.ClipsDescendants = true
    MainFrame.Parent = ScreenGui
    
    -- Shadow effect
    local Shadow = Instance.new("ImageLabel")
    Shadow.Size = UDim2.new(1, 0, 1, 0)
    Shadow.BackgroundTransparency = 1
    Shadow.Image = "rbxassetid://5554236805"
    Shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
    Shadow.ScaleType = Enum.ScaleType.Slice
    Shadow.SliceCenter = Rect.new(23,23,277,277)
    Shadow.Parent = MainFrame
    
    -- Corner rounding
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 12)
    UICorner.Parent = MainFrame
    
    -- Top bar
    local TopBar = Instance.new("Frame")
    TopBar.Size = UDim2.new(1, 0, 0, 35)
    TopBar.BackgroundColor3 = sidebarColor
    TopBar.BorderSizePixel = 0
    TopBar.Parent = MainFrame
    
    local TopBarCorner = Instance.new("UICorner")
    TopBarCorner.CornerRadius = UDim.new(0, 12)
    TopBarCorner.Parent = TopBar
    
    -- Title
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(0, 200, 1, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "Modern DarkUI"
    Title.TextColor3 = accentColor
    Title.TextSize = 16
    Title.Font = Enum.Font.GothamBold
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Position = UDim2.new(0, 15, 0, 0)
    Title.Parent = TopBar
    
    -- Close button
    local CloseButton = Instance.new("TextButton")
    CloseButton.Size = UDim2.new(0, 25, 0, 25)
    CloseButton.Position = UDim2.new(1, -30, 0.5, -12.5)
    CloseButton.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
    CloseButton.Text = "√ó"
    CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseButton.TextSize = 18
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.Parent = TopBar
    
    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(1, 0)
    CloseCorner.Parent = CloseButton
    
    -- Minimize button
    local MinimizeButton = Instance.new("TextButton")
    MinimizeButton.Size = UDim2.new(0, 25, 0, 25)
    MinimizeButton.Position = UDim2.new(1, -65, 0.5, -12.5)
    MinimizeButton.BackgroundColor3 = Color3.fromRGB(255, 170, 0)
    MinimizeButton.Text = "‚àí"
    MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    MinimizeButton.TextSize = 18
    MinimizeButton.Font = Enum.Font.GothamBold
    MinimizeButton.Parent = TopBar
    
    local MinimizeCorner = Instance.new("UICorner")
    MinimizeCorner.CornerRadius = UDim.new(1, 0)
    MinimizeCorner.Parent = MinimizeButton
    
    -- Minimized icon (hidden initially)
    local MinimizedIcon = Instance.new("TextButton")
    MinimizedIcon.Size = UDim2.new(0, 50, 0, 50)
    MinimizedIcon.Position = UDim2.new(0, 20, 0, 20)
    MinimizedIcon.BackgroundColor3 = accentColor
    MinimizedIcon.Text = "‚öôÔ∏è"
    MinimizedIcon.TextSize = 20
    MinimizedIcon.Visible = false
    MinimizedIcon.Parent = ScreenGui
    
    local IconCorner = Instance.new("UICorner")
    IconCorner.CornerRadius = UDim.new(1, 0)
    IconCorner.Parent = MinimizedIcon
    
    -- Sidebar for tabs
    local SideBar = Instance.new("Frame")
    SideBar.Size = UDim2.new(0, 150, 1, -35)
    SideBar.Position = UDim2.new(0, 0, 0, 35)
    SideBar.BackgroundColor3 = sidebarColor
    SideBar.BorderSizePixel = 0
    SideBar.Parent = MainFrame
    
    -- Content area
    local ContentFrame = Instance.new("Frame")
    ContentFrame.Size = UDim2.new(1, -150, 1, -35)
    ContentFrame.Position = UDim2.new(0, 150, 0, 35)
    ContentFrame.BackgroundColor3 = backgroundColor
    ContentFrame.BorderSizePixel = 0
    ContentFrame.Parent = MainFrame
    
    local ContentScrolling = Instance.new("ScrollingFrame")
    ContentScrolling.Size = UDim2.new(1, -20, 1, -20)
    ContentScrolling.Position = UDim2.new(0, 10, 0, 10)
    ContentScrolling.BackgroundTransparency = 1
    ContentScrolling.BorderSizePixel = 0
    ContentScrolling.ScrollBarThickness = 4
    ContentScrolling.ScrollBarImageColor3 = accentColor
    ContentScrolling.CanvasSize = UDim2.new(0, 0, 0, 0)
    ContentScrolling.Parent = ContentFrame
    
    local ContentLayout = Instance.new("UIListLayout")
    ContentLayout.Padding = UDim.new(0, 12)
    ContentLayout.Parent = ContentScrolling
    
    -- Tab buttons container
    local TabButtonsFrame = Instance.new("Frame")
    TabButtonsFrame.Size = UDim2.new(1, 0, 1, -50)
    TabButtonsFrame.Position = UDim2.new(0, 0, 0, 0)
    TabButtonsFrame.BackgroundTransparency = 1
    TabButtonsFrame.Parent = SideBar
    
    local TabButtonsLayout = Instance.new("UIListLayout")
    TabButtonsLayout.Padding = UDim.new(0, 8)
    TabButtonsLayout.Parent = TabButtonsFrame
    
    -- Premium badge
    local PremiumBadge = Instance.new("TextLabel")
    PremiumBadge.Size = UDim2.new(1, -20, 0, 35)
    PremiumBadge.Position = UDim2.new(0, 10, 1, -45)
    PremiumBadge.BackgroundColor3 = Color3.fromRGB(255, 170, 0)
    PremiumBadge.Text = "üî• PREMIUM"
    PremiumBadge.TextColor3 = Color3.fromRGB(255, 255, 255)
    PremiumBadge.TextSize = 12
    PremiumBadge.Font = Enum.Font.GothamBold
    PremiumBadge.Parent = SideBar
    
    local PremiumCorner = Instance.new("UICorner")
    PremiumCorner.CornerRadius = UDim.new(0, 8)
    PremiumCorner.Parent = PremiumBadge
    
    -- Close button functionality
    CloseButton.MouseButton1Click:Connect(function()
        local tween = TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
            Size = UDim2.new(0, 0, 0, 0)
        })
        tween:Play()
        tween.Completed:Wait()
        ScreenGui:Destroy()
    end)
    
    -- Minimize button functionality
    MinimizeButton.MouseButton1Click:Connect(function()
        if uiVisible then
            -- Minimize
            local tween = TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
                Size = UDim2.new(0, 0, 0, 0)
            })
            tween:Play()
            MinimizedIcon.Visible = true
            uiVisible = false
        else
            -- Restore
            local tween = TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
                Size = UDim2.new(0, 600, 0, 450)
            })
            tween:Play()
            MinimizedIcon.Visible = false
            uiVisible = true
        end
    end)
    
    -- Minimized icon functionality
    MinimizedIcon.MouseButton1Click:Connect(function()
        local tween = TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
            Size = UDim2.new(0, 600, 0, 450)
        })
        tween:Play()
        MinimizedIcon.Visible = false
        uiVisible = true
    end)
    
    -- Make window draggable
    local dragging
    local dragInput
    local dragStart
    local startPos
    
    local function update(input)
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
    
    TopBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = MainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    TopBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    game:GetService("UserInputService").InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
    
    function library:MakeWindow(config)
        Title.Text = config.Name or "Modern DarkUI"
        return library
    end
    
    function library:MakeTab(tabConfig)
        local tab = {}
        local tabElements = {}
        local tabButton
        
        -- Create tab button
        tabButton = Instance.new("TextButton")
        tabButton.Size = UDim2.new(1, -20, 0, 40)
        tabButton.BackgroundColor3 = elementColor
        tabButton.Text = tabConfig.Name
        tabButton.TextColor3 = textColor
        tabButton.TextSize = 14
        tabButton.Font = Enum.Font.Gotham
        tabButton.AutoButtonColor = false
        tabButton.Parent = TabButtonsFrame
        
        local tabCorner = Instance.new("UICorner")
        tabCorner.CornerRadius = UDim.new(0, 8)
        tabCorner.Parent = tabButton
        
        -- Tab content (initially hidden)
        local tabContent = Instance.new("Frame")
        tabContent.Size = UDim2.new(1, 0, 0, 0)
        tabContent.BackgroundTransparency = 1
        tabContent.Visible = false
        tabContent.Parent = ContentScrolling
        
        local tabContentLayout = Instance.new("UIListLayout")
        tabContentLayout.Padding = UDim.new(0, 12)
        tabContentLayout.Parent = tabContent
        
        -- Select first tab by default
        if #tabs == 0 then
            tabButton.BackgroundColor3 = accentColor
            tabContent.Visible = true
            currentTab = tabContent
        end
        
        local function selectTab()
            -- Hide all tab contents
            for _, existingTab in pairs(tabs) do
                existingTab.content.Visible = false
                TweenService:Create(existingTab.button, TweenInfo.new(0.2), {
                    BackgroundColor3 = elementColor
                }):Play()
            end
            
            -- Show this tab content
            tabContent.Visible = true
            TweenService:Create(tabButton, TweenInfo.new(0.2), {
                BackgroundColor3 = accentColor
            }):Play()
            currentTab = tabContent
        end
        
        tabButton.MouseButton1Click:Connect(selectTab)
        
        -- Button hover effects
        tabButton.MouseEnter:Connect(function()
            if tabButton.BackgroundColor3 ~= accentColor then
                TweenService:Create(tabButton, TweenInfo.new(0.2), {
                    BackgroundColor3 = Color3.fromRGB(50, 50, 50)
                }):Play()
            end
        end)
        
        tabButton.MouseLeave:Connect(function()
            if tabButton.BackgroundColor3 ~= accentColor then
                TweenService:Create(tabButton, TweenInfo.new(0.2), {
                    BackgroundColor3 = elementColor
                }):Play()
            end
        end)
        
        -- Function to create element container
        local function createElementContainer(height)
            local container = Instance.new("Frame")
            container.Size = UDim2.new(1, 0, 0, height)
            container.BackgroundColor3 = elementColor
            container.Parent = tabContent
            
            local corner = Instance.new("UICorner")
            corner.CornerRadius = UDim.new(0, 8)
            corner.Parent = container
            
            return container
        end
        
        -- Button element
        function tab:AddButton(buttonConfig)
            local container = createElementContainer(40)
            
            local button = Instance.new("TextButton")
            button.Size = UDim2.new(1, -20, 1, -10)
            button.Position = UDim2.new(0, 10, 0, 5)
            button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            button.Text = buttonConfig.Name
            button.TextColor3 = textColor
            button.TextSize = 14
            button.Font = Enum.Font.Gotham
            button.AutoButtonColor = false
            button.Parent = container
            
            local buttonCorner = Instance.new("UICorner")
            buttonCorner.CornerRadius = UDim.new(0, 6)
            buttonCorner.Parent = button
            
            -- Hover effects
            button.MouseEnter:Connect(function()
                TweenService:Create(button, TweenInfo.new(0.2), {
                    BackgroundColor3 = accentColor
                }):Play()
            end)
            
            button.MouseLeave:Connect(function()
                TweenService:Create(button, TweenInfo.new(0.2), {
                    BackgroundColor3 = Color3.fromRGB(50, 50, 50)
                }):Play()
            end)
            
            button.MouseButton1Click:Connect(function()
                TweenService:Create(button, TweenInfo.new(0.1), {
                    BackgroundTransparency = 0.5
                }):Play()
                TweenService:Create(button, TweenInfo.new(0.1), {
                    BackgroundTransparency = 0
                }):Play()
                buttonConfig.Callback()
            end)
            
            -- Update canvas size
            tabContent.Size = UDim2.new(1, 0, 0, tabContentLayout.AbsoluteContentSize.Y)
            ContentScrolling.CanvasSize = UDim2.new(0, 0, 0, tabContentLayout.AbsoluteContentSize.Y + 20)
            
            return button
        end
        
        -- Toggle element
        function tab:AddToggle(toggleConfig)
            local container = createElementContainer(40)
            
            local toggleLabel = Instance.new("TextLabel")
            toggleLabel.Size = UDim2.new(0.7, 0, 1, 0)
            toggleLabel.BackgroundTransparency = 1
            toggleLabel.Text = toggleConfig.Name
            toggleLabel.TextColor3 = textColor
            toggleLabel.TextSize = 14
            toggleLabel.Font = Enum.Font.Gotham
            toggleLabel.TextXAlignment = Enum.TextXAlignment.Left
            toggleLabel.Position = UDim2.new(0, 15, 0, 0)
            toggleLabel.Parent = container
            
            local toggleButton = Instance.new("TextButton")
            toggleButton.Size = UDim2.new(0, 50, 0, 25)
            toggleButton.Position = UDim2.new(1, -65, 0.5, -12.5)
            toggleButton.BackgroundColor3 = elementColor
            toggleButton.Text = ""
            toggleButton.AutoButtonColor = false
            toggleButton.Parent = container
            
            local toggleCorner = Instance.new("UICorner")
            toggleCorner.CornerRadius = UDim.new(1, 0)
            toggleCorner.Parent = toggleButton
            
            local toggleState = toggleConfig.Default or false
            
            local function updateToggle()
                if toggleState then
                    TweenService:Create(toggleButton, TweenInfo.new(0.2), {
                        BackgroundColor3 = accentColor
                    }):Play()
                else
                    TweenService:Create(toggleButton, TweenInfo.new(0.2), {
                        BackgroundColor3 = elementColor
                    }):Play()
                end
                toggleConfig.Callback(toggleState)
            end
            
            toggleButton.MouseButton1Click:Connect(function()
                toggleState = not toggleState
                updateToggle()
            end)
            
            updateToggle()
            
            -- Update canvas size
            tabContent.Size = UDim2.new(1, 0, 0, tabContentLayout.AbsoluteContentSize.Y)
            ContentScrolling.CanvasSize = UDim2.new(0, 0, 0, tabContentLayout.AbsoluteContentSize.Y + 20)
            
            return toggleButton
        end
        
        -- Slider element
        function tab:AddSlider(sliderConfig)
            local container = createElementContainer(60)
            
            local sliderLabel = Instance.new("TextLabel")
            sliderLabel.Size = UDim2.new(1, -20, 0, 20)
            sliderLabel.Position = UDim2.new(0, 15, 0, 5)
            sliderLabel.BackgroundTransparency = 1
            sliderLabel.Text = sliderConfig.Name .. ": " .. sliderConfig.Default
            sliderLabel.TextColor3 = textColor
            sliderLabel.TextSize = 14
            sliderLabel.Font = Enum.Font.Gotham
            sliderLabel.TextXAlignment = Enum.TextXAlignment.Left
            sliderLabel.Parent = container
            
            local sliderTrack = Instance.new("Frame")
            sliderTrack.Size = UDim2.new(1, -30, 0, 6)
            sliderTrack.Position = UDim2.new(0, 15, 1, -20)
            sliderTrack.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            sliderTrack.Parent = container
            
            local trackCorner = Instance.new("UICorner")
            trackCorner.CornerRadius = UDim.new(1, 0)
            trackCorner.Parent = sliderTrack
            
            local sliderFill = Instance.new("Frame")
            sliderFill.Size = UDim2.new(0, 0, 1, 0)
            sliderFill.BackgroundColor3 = accentColor
            sliderFill.Parent = sliderTrack
            
            local fillCorner = Instance.new("UICorner")
            fillCorner.CornerRadius = UDim.new(1, 0)
            fillCorner.Parent = sliderFill
            
            local sliderButton = Instance.new("TextButton")
            sliderButton.Size = UDim2.new(0, 16, 0, 16)
            sliderButton.Position = UDim2.new(0, -8, 0.5, -8)
            sliderButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            sliderButton.Text = ""
            sliderButton.Parent = sliderFill
            
            local buttonCorner = Instance.new("UICorner")
            buttonCorner.CornerRadius = UDim.new(1, 0)
            buttonCorner.Parent = sliderButton
            
            local currentValue = sliderConfig.Default or sliderConfig.Min
            local sliding = false
            
            local function updateSlider(value)
                currentValue = math.clamp(value, sliderConfig.Min, sliderConfig.Max)
                local percentage = (currentValue - sliderConfig.Min) / (sliderConfig.Max - sliderConfig.Min)
                
                TweenService:Create(sliderFill, TweenInfo.new(0.1), {
                    Size = UDim2.new(percentage, 0, 1, 0)
                }):Play()
                
                sliderLabel.Text = sliderConfig.Name .. ": " .. currentValue
                sliderConfig.Callback(currentValue)
            end
            
            sliderButton.MouseButton1Down:Connect(function()
                sliding = true
            end)
            
            game:GetService("UserInputService").InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    sliding = false
                end
            end)
            
            game:GetService("UserInputService").InputChanged:Connect(function(input)
                if sliding and input.UserInputType == Enum.UserInputType.MouseMovement then
                    local mousePos = game:GetService("UserInputService"):GetMouseLocation()
                    local trackAbsPos = sliderTrack.AbsolutePosition
                    local trackAbsSize = sliderTrack.AbsoluteSize
                    
                    local relativeX = (mousePos.X - trackAbsPos.X) / trackAbsSize.X
                    relativeX = math.clamp(relativeX, 0, 1)
                    
                    local value = sliderConfig.Min + (relativeX * (sliderConfig.Max - sliderConfig.Min))
                    value = math.floor(value / sliderConfig.Increment) * sliderConfig.Increment
                    
                    updateSlider(value)
                end
            end)
            
            updateSlider(currentValue)
            
            -- Update canvas size
            tabContent.Size = UDim2.new(1, 0, 0, tabContentLayout.AbsoluteContentSize.Y)
            ContentScrolling.CanvasSize = UDim2.new(0, 0, 0, tabContentLayout.AbsoluteContentSize.Y + 20)
            
            return container
        end
        
        -- Textbox element
        function tab:AddTextbox(textboxConfig)
            local container = createElementContainer(45)
            
            local textbox = Instance.new("TextBox")
            textbox.Size = UDim2.new(1, -20, 1, -10)
            textbox.Position = UDim2.new(0, 10, 0, 5)
            textbox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            textbox.TextColor3 = textColor
            textbox.TextSize = 14
            textbox.Font = Enum.Font.Gotham
            textbox.PlaceholderText = textboxConfig.Name
            textbox.Text = textboxConfig.Default or ""
            textbox.ClearTextOnFocus = textboxConfig.TextDisappear or false
            textbox.Parent = container
            
            local textboxCorner = Instance.new("UICorner")
            textboxCorner.CornerRadius = UDim.new(0, 6)
            textboxCorner.Parent = textbox
            
            textbox.FocusLost:Connect(function(enterPressed)
                if enterPressed then
                    textboxConfig.Callback(textbox.Text)
                end
            end)
            
            -- Update canvas size
            tabContent.Size = UDim2.new(1, 0, 0, tabContentLayout.AbsoluteContentSize.Y)
            ContentScrolling.CanvasSize = UDim2.new(0, 0, 0, tabContentLayout.AbsoluteContentSize.Y + 20)
            
            return textbox
        end
        
        -- Dropdown element
        function tab:AddDropdown(dropdownConfig)
            local container = createElementContainer(40)
            local dropdownOpen = false
            
            local dropdownButton = Instance.new("TextButton")
            dropdownButton.Size = UDim2.new(1, -20, 1, -10)
            dropdownButton.Position = UDim2.new(0, 10, 0, 5)
            dropdownButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            dropdownButton.Text = dropdownConfig.Name .. ": " .. dropdownConfig.Default
            dropdownButton.TextColor3 = textColor
            dropdownButton.TextSize = 14
            dropdownButton.Font = Enum.Font.Gotham
            dropdownButton.AutoButtonColor = false
            dropdownButton.Parent = container
            
            local dropdownCorner = Instance.new("UICorner")
            dropdownCorner.CornerRadius = UDim.new(0, 6)
            dropdownCorner.Parent = dropdownButton
            
            local dropdownFrame = Instance.new("Frame")
            dropdownFrame.Size = UDim2.new(1, -20, 0, 0)
            dropdownFrame.Position = UDim2.new(0, 10, 1, 5)
            dropdownFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
            dropdownFrame.ClipsDescendants = true
            dropdownFrame.Visible = false
            dropdownFrame.Parent = container
            
            local dropdownCorner2 = Instance.new("UICorner")
            dropdownCorner2.CornerRadius = UDim.new(0, 6)
            dropdownCorner2.Parent = dropdownFrame
            
            local dropdownLayout = Instance.new("UIListLayout")
            dropdownLayout.Parent = dropdownFrame
            
            local currentOption = dropdownConfig.Default
            
            local function updateDropdown()
                dropdownButton.Text = dropdownConfig.Name .. ": " .. currentOption
                dropdownConfig.Callback(currentOption)
            end
            
            local function toggleDropdown()
                dropdownOpen = not dropdownOpen
                if dropdownOpen then
                    dropdownFrame.Visible = true
                    TweenService:Create(dropdownFrame, TweenInfo.new(0.2), {
                        Size = UDim2.new(1, -20, 0, #dropdownConfig.Options * 35)
                    }):Play()
                else
                    TweenService:Create(dropdownFrame, TweenInfo.new(0.2), {
                        Size = UDim2.new(1, -20, 0, 0)
                    }):Play()
                    wait(0.2)
                    dropdownFrame.Visible = false
                end
            end
            
            dropdownButton.MouseButton1Click:Connect(toggleDropdown)
            
            -- Create option buttons
            for i, option in ipairs(dropdownConfig.Options) do
                local optionButton = Instance.new("TextButton")
                optionButton.Size = UDim2.new(1, 0, 0, 35)
                optionButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
                optionButton.Text = option
                optionButton.TextColor3 = textColor
                optionButton.TextSize = 14
                optionButton.Font = Enum.Font.Gotham
                optionButton.AutoButtonColor = false
                optionButton.Parent = dropdownFrame
                
                optionButton.MouseButton1Click:Connect(function()
                    currentOption = option
                    updateDropdown()
                    toggleDropdown()
                end)
                
                optionButton.MouseEnter:Connect(function()
                    TweenService:Create(optionButton, TweenInfo.new(0.2), {
                        BackgroundColor3 = accentColor
                    }):Play()
                end)
                
                optionButton.MouseLeave:Connect(function()
                    TweenService:Create(optionButton, TweenInfo.new(0.2), {
                        BackgroundColor3 = Color3.fromRGB(50, 50, 50)
                    }):Play()
                end)
            end
            
            updateDropdown()
            
            -- Update canvas size
            tabContent.Size = UDim2.new(1, 0, 0, tabContentLayout.AbsoluteContentSize.Y)
            ContentScrolling.CanvasSize = UDim2.new(0, 0, 0, tabContentLayout.AbsoluteContentSize.Y + 20)
            
            return container
        end
        
        -- Keybind element
        function tab:AddKeybind(keybindConfig)
            local container = createElementContainer(40)
            local listening = false
            local currentKey = keybindConfig.Default or Enum.KeyCode.E
            
            local keybindLabel = Instance.new("TextLabel")
            keybindLabel.Size = UDim2.new(0.6, 0, 1, 0)
            keybindLabel.BackgroundTransparency = 1
            keybindLabel.Text = keybindConfig.Name
            keybindLabel.TextColor3 = textColor
            keybindLabel.TextSize = 14
            keybindLabel.Font = Enum.Font.Gotham
            keybindLabel.TextXAlignment = Enum.TextXAlignment.Left
            keybindLabel.Position = UDim2.new(0, 15, 0, 0)
            keybindLabel.Parent = container
            
            local keybindButton = Instance.new("TextButton")
            keybindButton.Size = UDim2.new(0, 80, 0, 25)
            keybindButton.Position = UDim2.new(1, -95, 0.5, -12.5)
            keybindButton.BackgroundColor3 = elementColor
            keybindButton.Text = tostring(currentKey):gsub("Enum.KeyCode.", "")
            keybindButton.TextColor3 = textColor
            keybindButton.TextSize = 12
            keybindButton.Font = Enum.Font.Gotham
            keybindButton.AutoButtonColor = false
            keybindButton.Parent = container
            
            local keybindCorner = Instance.new("UICorner")
            keybindCorner.CornerRadius = UDim.new(0, 6)
            keybindCorner.Parent = keybindButton
            
            local function updateKeybind()
                keybindButton.Text = tostring(currentKey):gsub("Enum.KeyCode.", "")
                keybinds[currentKey] = keybindConfig.Callback
            end
            
            keybindButton.MouseButton1Click:Connect(function()
                listening = true
                keybindButton.Text = "..."
                keybindButton.BackgroundColor3 = accentColor
            end)
            
            game:GetService("UserInputService").InputBegan:Connect(function(input)
                if listening and input.UserInputType == Enum.UserInputType.Keyboard then
                    currentKey = input.KeyCode
                    listening = false
                    updateKeybind()
                    keybindButton.BackgroundColor3 = elementColor
                end
            end)
            
            updateKeybind()
            
            -- Update canvas size
            tabContent.Size = UDim2.new(1, 0, 0, tabContentLayout.AbsoluteContentSize.Y)
            ContentScrolling.CanvasSize = UDim2.new(0, 0, 0, tabContentLayout.AbsoluteContentSize.Y + 20)
            
            return container
        end
        
        -- Label element
        function tab:AddLabel(labelConfig)
            local container = createElementContainer(30)
            container.BackgroundTransparency = 1
            
            local label = Instance.new("TextLabel")
            label.Size = UDim2.new(1, -20, 1, 0)
            label.Position = UDim2.new(0, 10, 0, 0)
            label.BackgroundTransparency = 1
            label.Text = labelConfig.Name
            label.TextColor3 = textColor
            label.TextSize = 16
            label.Font = Enum.Font.GothamBold
            label.TextXAlignment = Enum.TextXAlignment.Left
            label.Parent = container
            
            -- Update canvas size
            tabContent.Size = UDim2.new(1, 0, 0, tabContentLayout.AbsoluteContentSize.Y)
            ContentScrolling.CanvasSize = UDim2.new(0, 0, 0, tabContentLayout.AbsoluteContentSize.Y + 20)
            
            return label
        end
        
        -- Paragraph element
        function tab:AddParagraph(paragraphConfig)
            local container = createElementContainer(120)
            
            local title = Instance.new("TextLabel")
            title.Size = UDim2.new(1, -20, 0, 25)
            title.Position = UDim2.new(0, 10, 0, 5)
            title.BackgroundTransparency = 1
            title.Text = paragraphConfig.Name or "Paragraph"
            title.TextColor3 = textColor
            title.TextSize = 16
            title.Font = Enum.Font.GothamBold
            title.TextXAlignment = Enum.TextXAlignment.Left
            title.Parent = container
            
            local content = Instance.new("TextLabel")
            content.Size = UDim2.new(1, -20, 1, -35)
            content.Position = UDim2.new(0, 10, 0, 30)
            content.BackgroundTransparency = 1
            content.Text = paragraphConfig.Content or ""
            content.TextColor3 = Color3.fromRGB(200, 200, 200)
            content.TextSize = 12
            content.Font = Enum.Font.Gotham
            content.TextXAlignment = Enum.TextXAlignment.Left
            content.TextYAlignment = Enum.TextYAlignment.Top
            content.TextWrapped = true
            content.Parent = container
            
            -- Update canvas size
            tabContent.Size = UDim2.new(1, 0, 0, tabContentLayout.AbsoluteContentSize.Y)
            ContentScrolling.CanvasSize = UDim2.new(0, 0, 0, tabContentLayout.AbsoluteContentSize.Y + 20)
            
            return container
        end
        
        -- Store tab data
        table.insert(tabs, {
            button = tabButton,
            content = tabContent,
            elements = tabElements
        })
        
        -- Update tab buttons layout
        TabButtonsFrame.Size = UDim2.new(1, 0, 0, (#tabs * 48) + 10)
        
        return tab
    end
    
    -- Keybind system
    game:GetService("UserInputService").InputBegan:Connect(function(input)
        if keybinds[input.KeyCode] then
            keybinds[input.KeyCode]()
        end
    end)
    
    -- Toggle UI keybind (default: Right Control)
    keybinds[Enum.KeyCode.RightControl] = function()
        MinimizeButton:Click()
    end
    
    function library:Init()
        print("Modern DarkUI Library Initialized!")
        print("Press Right Control to toggle UI")
        return library
    end
    
    function library:Destroy()
        ScreenGui:Destroy()
    end
    
    return library
end

return DarkUI
